<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bank Balance Checker</title>
  <style>
    body {
      font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
      background: #f0f4f8;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 50px;
    }

    h2 {
        color: #333;
      text-shadow: 0 2px 10px rgb(177, 175, 175);
    }
    
    h3 {
        color: #333;
      text-shadow: 0 2px 10px rgb(177, 175, 175);
    }
    .checker {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      max-width: 400px;
      width: 100%;
    }

    input, button {
      padding: 10px;
      margin-top: 10px;
      width: 95%;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
      
    }

    button {
      background-color: #007bff;
      width: 100%;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    .result {
      margin-top: 20px;
      font-size: 1.2rem;
      color: green;
      padding: 5px;
      text-align: center;
    }

    .error {
      color: red;
    }
    .responsive-img {
    height: 100px;
    width: auto;
    display: block;
    margin: 0 auto;
    }
    .responsive-text {
    font-size: 5vw;
   }
    .responsive-text2 {
    font-size: 4.5vw;
    }
    .centered-text {
    text-align: center;
    }
  </style>
</head>
<body>
  <h1>
  <img src="บ้านนา.png" alt="Logo" class="responsive-img" style="height:100px; vertical-align:middle;">
</h1>
<h2 class="responsive-text centered-text">P.6 Balance Checker</h2>
<h3 class="responsive-text2 centered-text">เช็คยอดเงินออม ป.6<br>โรงเรียนวัดบ้านนา ปี 2568</h3>
  <div class="checker">
    <label for="password">กรอกรหัสผ่าน:</label>
    <input type="password" id="password" placeholder="ววดดปปปป"/>
    <button onclick="checkBalance()">ตรวจสอบยอดออม</button>
    <div id="result" class="result"></div>
  </div>

  <script>
    const SHEET_ID = "1oJFtvw8qsR1ExstkB2VN8y8zfzC4FC2RuxR8x8uTrG0";
    const SHEET_NAME = "ชีต2";
    const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;

    async function checkBalance() {
      const password = document.getElementById("password").value.trim();
      const resultEl = document.getElementById("result");
      resultEl.innerHTML = "กำลังโหลดข้อมูล...";

      try {
        const response = await fetch(CSV_URL);
        const csvText = await response.text();

        const rows = csvText
  .split("\n")
  .map(row => row.split(",").map(cell => cell.replace(/^"|"$/g, "").trim()));
        const headers = rows[0];
        const dataRows = rows.slice(1);

        const passwordIndex = headers.findIndex(h => h.trim() === "password");
        const balanceIndex = headers.findIndex(h => h.trim() === "balance");
        const nameIndex = headers.findIndex(h => h.trim() === "name");
        const dateIndex = headers.findIndex(h => h.trim() === "date");
        const match = dataRows.find(row => row[passwordIndex]?.trim() === password);
       

        if (match) {
          const balance = match[balanceIndex];
          const name = match[nameIndex];
          resultEl.innerHTML = `ชื่อ: ${name} <br> ยอดเงินของคุณคือ: ${balance} บาท ข้อมูล ณ วันที่ ${date}`;
          resultEl.className = "result";
        } else {
          resultEl.innerHTML = "ไม่พบรหัสผ่านนี้ในระบบ";
          resultEl.className = "result error";
        }
      } catch (err) {
        resultEl.innerHTML = "เกิดข้อผิดพลาดในการโหลดข้อมูล";
        resultEl.className = "result error";
        console.error(err);
      }
    }
  </script>
</body>
</html>
